<!DOCTYPE html>
<html lang="en-us">
<head>
  <meta charset="utf-8">
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <title>Unity WebGL Player | MyBarStory</title>
  <style>
    body, html {
      width: 100%;
      height: 100%;
      margin: 0;
      padding: 0;
      overflow: hidden;
    }
    #unity-canvas {
      width: 100%;
      height: 100%;
      background: #231F20;
      position: absolute;
    }
  </style>
</head>
<body>
  <canvas id="unity-canvas" tabindex="-1"></canvas>
  <script src="Build/TestAPIBuild.loader.js"></script>
  <script>
    function openFullscreen() {
      if (document.documentElement.requestFullscreen) {
        document.documentElement.requestFullscreen();
      } else if (document.documentElement.mozRequestFullScreen) { // Firefox
        document.documentElement.mozRequestFullScreen();
      } else if (document.documentElement.webkitRequestFullscreen) { // Chrome, Safari, Opera
        document.documentElement.webkitRequestFullscreen();
      } else if (document.documentElement.msRequestFullscreen) { // IE/Edge
        document.documentElement.msRequestFullscreen();
      }
    }

    function lockOrientation() {
      if (screen.orientation && screen.orientation.lock) {
        screen.orientation.lock('landscape').catch(function(error) {
          console.error('Orientation lock failed: ', error);
        });
      } else if (screen.lockOrientation) {
        screen.lockOrientation('landscape');
      } else if (screen.mozLockOrientation) {
        screen.mozLockOrientation('landscape');
      } else if (screen.msLockOrientation) {
        screen.msLockOrientation('landscape');
      } else {
        console.warn('Orientation lock is not supported in this browser.');
      }
    }

    function handleOrientationChange() {
      if (window.innerHeight > window.innerWidth) {
        // Landscape mode required
        alert('Please rotate your device to landscape mode');
        // Optionally, you can reload the page or take other actions
        window.addEventListener('orientationchange', function() {
          if (window.innerHeight <= window.innerWidth) {
            location.reload();
          }
        });
      }
    }

    function initialize() {
      openFullscreen();
      setTimeout(lockOrientation, 1000); // Delay to ensure fullscreen is applied before locking orientation

      // Mobile device handling
      if (/iPhone|iPad|iPod|Android/i.test(navigator.userAgent)) {
        var meta = document.createElement('meta');
        meta.name = 'viewport';
        meta.content = 'width=device-width, height=device-height, initial-scale=1.0, user-scalable=no, shrink-to-fit=yes';
        document.getElementsByTagName('head')[0].appendChild(meta);

        var canvas = document.querySelector("#unity-canvas");
        canvas.style.width = "100%";
        canvas.style.height = "100%";
        canvas.style.position = "fixed";

        document.body.style.textAlign = "left";

        // Handle orientation change
        handleOrientationChange();
      }
    }

    document.addEventListener("DOMContentLoaded", function () {
      initialize();

      createUnityInstance(document.querySelector("#unity-canvas"), {
        dataUrl: "Build/TestAPIBuild.data",
        frameworkUrl: "Build/TestAPIBuild.framework.js",
        codeUrl: "Build/TestAPIBuild.wasm",
        streamingAssetsUrl: "StreamingAssets",
        companyName: "DefaultCompany",
        productName: "MyBarStory",
        productVersion: "0.1",
        // matchWebGLToCanvasSize: false, // Uncomment this to separately control WebGL canvas render size and DOM element size.
        // devicePixelRatio: 1, // Uncomment this to override low DPI rendering on high DPI displays.
      }).then((instance) => {
        console.log("Unity instance created successfully.");
      }).catch((error) => {
        console.error("Error creating Unity instance:", error);
      });
    });
  </script>
</body>
</html>
